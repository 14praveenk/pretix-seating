{% extends "pretixcontrol/event/settings_base.html" %}
{% load i18n %}
{% load bootstrap3 %}

{% block title %}{% trans "Seating plan" %}{% endblock %}

{% block inside %}
{% if plan_summary %}
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">{% trans "Current seating plan" %}</h3>
    </div>
    <div class="panel-body">
        <p class="text-muted">
            {% blocktrans with name=plan_summary.name count seat_count=plan_summary.seat_count %}
                The plan "{{ name }}" currently provides {{ seat_count }} seat.
            {% plural %}
                The plan "{{ name }}" currently provides {{ seat_count }} seats.
            {% endblocktrans %}
        </p>
        {% if plan_summary.categories %}
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>{% trans "Category" %}</th>
                        <th>{% trans "Assigned products" %}</th>
                    </tr>
                </thead>
                <tbody>
                {% for category in plan_summary.categories %}
                    <tr>
                        <td>{{ category.name }}</td>
                        <td>
                            {% if category.products %}
                                <ul class="list-inline quse-plan-mapping-list">
                                    {% for product in category.products %}
                                        <li>{{ product }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <span class="text-muted">{% trans "Not mapped" %}</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
        <details class="quse-plan-preview">
            <summary>{% trans "Show raw layout JSON" %}</summary>
            <pre>{{ plan_summary.layout_json }}</pre>
        </details>
    </div>
</div>
{% endif %}
<form action="" method="post" enctype="multipart/form-data" class="form-horizontal">
    {% csrf_token %}
    <fieldset>
        <legend>{% trans "Seating plan" %}</legend>
        {% bootstrap_form form layout="horizontal" %}
    </fieldset>
    <div class="form-group submit-group">
        <div class="col-md-9 col-md-offset-3">
            <button type="submit" class="btn btn-primary btn-save">
                {% trans "Save" %}
            </button>
        </div>
    </div>
</form>
{% endblock %}
